[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:searxng]
command=python searx/webapp.py
directory=/usr/local/searxng
user=appuser
autostart=true
autorestart=true
stderr_logfile=/var/log/searxng/stderr.log
stdout_logfile=/var/log/searxng/stdout.log
environment=SEARXNG_SETTINGS_PATH="/etc/searxng/settings.yml",SEARXNG_SECRET="%(ENV_SEARXNG_SECRET_KEY)s",BIND_ADDRESS="0.0.0.0:8080"
startsecs=5

[program:api]
command=uvicorn main:app --host 0.0.0.0 --port 8000 --log-level info
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/api-stderr.log
stdout_logfile=/var/log/supervisor/api-stdout.log
# Wait for SearXNG to start
startsecs=10
